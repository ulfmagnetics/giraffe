{% extends "base.html" %}

{% block content %}
<div class="controls">
    <div class="search-sort-row">
        <div class="search-box">
            <input type="text" id="search" placeholder="Search tracks..." aria-label="Search tracks">
        </div>
        <button id="sort-toggle" class="sort-btn" data-order="desc" aria-label="Toggle sort order">Newest first â†“</button>
    </div>

    <div class="filters">
        <div class="tag-filters" id="tag-filters">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>

<div class="track-grid" id="track-grid">
    {% for track in tracks %}
    <article class="track-card"
             data-title="{{ track.title|lower }}"
             data-category="{{ track.category|lower }}"
             data-status="{{ track.status }}"
             data-tags="{{ track.tags|join(',') }}"
             data-year="{{ track.year }}"
             data-date="{{ track.slug }}">

        <a href="tracks/{{ track.slug }}.html" class="track-link">
            <div class="track-cover">
                <img src="covers/{{ track.cover_filename }}" alt="{{ track.title }} cover art" loading="lazy">
                {% if track.status == 'draft' %}
                <span class="badge badge-draft">Draft</span>
                {% elif track.status == 'work-in-progress' %}
                <span class="badge badge-wip">WIP</span>
                {% endif %}
            </div>

            <div class="track-info">
                <h2 class="track-title">{{ track.title }}</h2>
                <p class="track-meta">
                    <span class="track-year">{{ track.year }}</span>
                    {% if track.category %}
                    <span class="track-category">{{ track.category }}</span>
                    {% endif %}
                </p>

                {% if track.tags %}
                <div class="track-tags">
                    {% for tag in track.tags %}
                    <span class="tag">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </a>
    </article>
    {% endfor %}
</div>

<div id="no-results" class="no-results" style="display: none;">
    <p>No tracks found matching your filters.</p>
</div>
{% endblock %}
